<!DOCTYPE html> <!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]--> <!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]--> <!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html manifest="cache.manifest" class="no-js" lang="en"><!--<![endif]--> <head> <meta charset="utf-8"> <title>A two dimensional data structure - A personal Blog</title> <meta name="author" content="Manuel"> <meta name="keywords" content="2021, programming, memory, x86"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="apple-touch-icon" href="/style/touch-icon.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/style/touch-icon.png"> <link rel="canonical" href="https://manuel-io.github.io/blog/2021/01/23/a-2-dimensional-data-structure"> <link rel="shortcut icon" type="image/png" href="/favicon.png"> <link href="/stylesheets/screen.css" media="all" rel="stylesheet" type="text/css"> <link href="/atom.xml" rel="alternate" title="A personal Blog" type="application/atom+xml"> <script src="/javascripts/libs/jquery-1.11.2.min.js" type="text/javascript"></script> <script src="/javascripts/blog.js" type="text/javascript"></script> <script type="text/javascript" src="/javascripts/mathjax/unpacked/MathJax.js?config=TeX-AMS_HTML"></script> <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "jax": ["input/TeX", "output/HTML-CSS"],
    styles: { ".MathJax_Display": { "text-align": "left" } },
    "tex2jax": {
      inlineMath: [ ['$', '$'], ["\\(", "\\)"] ],
      displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: { autoNumber: "AMS" },
      TagSide: "left"
    },
    "HTML-CSS": {
      availableFonts: ["TeX"],
      linebreaks: { automatic: true }
    }
  });
</script> </head> <body> <header class='site'><h1> <a href="/"> <p>A</p> <p> </p> <p>p</p> <p>e</p> <p>r</p> <p>s</p> <p>o</p> <p>n</p> <p>a</p> <p>l</p> <p> </p> <p>B</p> <p>l</p> <p>o</p> <p>g</p> </a> </h1> </header> <div style='clear:both;'></div> <nav><span><a href="/">Blog</a></span> <span><a href="/blog/photography">Photography</a></span> <span><a href="http://vkitchen.herokuapp.com" target="_blank">Kitchen</a></span> <span><a href="https://minicloud.zahlenpresse.de" target="_blank">Minicloud</a></span> <span><a href="https://github.com/manuel-io" target="_blank">Github</a></span> <span><a href="https://de.wikipedia.org/wiki/Benutzer:Manuel_Bieling" target="_blank">Wikipedia</a></span> <span><a href="/blog/links">Links</a></span> <span><a href="/atom.xml">Feed</a></span> <span><a href="/blog/tags">Tags</a></span> <span><a href="/blog/archives">Archive</a></span> <span><a href="/blog/about">About</a></span> </nav> <article> <header class='post'> <h1 class="entry-title">A two dimensional data structure</h1> <p> <time class='entry-date' datetime='2021-01-23T14:38:11+01:00'><span class='date'>Jan, 2021-01-23 | </span> <span class='time'>Sat, 14:38 </span></time> </p> </header> <section><p>How does a 2 dimensional data structure look like in different programming languages. Using the C-Language you have to allocate the required memory by youself.</p> <pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdint.h&gt;
</code></pre> <p>Think of a map with x and y but keep in mind that the memory of a computer is still a one-dimensional linear thing. In addition each point of the map (x,y) requires some memory for the payload.</p> <pre><code>/* Payload */
struct tile {
  uint8_t id;
  uint8_t type;
};

int
main(int argc, char **argv) {
</code></pre> <p>In this example we use a map with an equal size of width and height.</p> <pre><code>  struct tile *tiles = NULL;
  uint8_t width = 12, height = 12;
</code></pre> <p>Thus the total line memory is <code>sizeof(payload) * width * height</code>. Next each point can be accessed with <code>offset + (y * width) + x</code>. Where offset is the return value of the POSIX C function <code>malloc</code>. Modern computers have a memory management unit, which is operated and controlled by the operating system. In this case malloc returns the start address of the granted memory area.</p> <pre><code>  tiles = (struct tile *)malloc(sizeof(struct tile) * width * height);

  if (tiles == NULL) {
    printf("Memory allocation failed\n");
    return 1;
  }
</code></pre> <p>We initialize the allocated memory area with our example payload. Thanks to pointer arithmetic we no longer have to care about the size of the payload.</p> <pre><code>  /* Initialization */
  for (uint8_t y = 0; y &lt; height; y++) {
    for (uint8_t x = 0; x &lt; width; x++) {
      /* Pointer Arithmetic: (tiles + (y * width * sizeof(struct tile)) + (x * sizeof(struct tile))) */
      (tiles + (y * width) + x)-&gt;id = y * width + x;
      (tiles + (y * width) + x)-&gt;type = 0;
    }
  }

  /* Print */
  for (uint8_t y = 0; y &lt; height; y++) {
    for (uint8_t x = 0; x &lt; width; x++) {
      printf("%d:\t(%d,%d)\t0x%lx\n", (tiles + (y * width) + x)-&gt;id, x, y, (uintptr_t)(tiles + (y * width) + x));
    }
  }
</code></pre> <p>The size of a tile (example payload) should be 2 Bytes and the total reserved memory area 12 * 12 * 2 = 288 Bytes. The offset address can&rsquo;t be predicted at this point. Note: Due to unpredictable compiler optimizations, deviations may occur. See <a href="https://gist.github.com/manuel-io/bbc5e7b0e899a5c13672b1e3d72bb0d0">https://gist.github.com/manuel-io/bbc5e7b0e899a5c13672b1e3d72bb0d0</a>.</p> <pre><code>  printf("\nSize of a tile: %ld bytes\n", sizeof(struct tile));
  printf("Offset address 0x%lx\n", (uintptr_t)tiles);
  printf("Reserved memory: %ld bytes\n", sizeof(struct tile) * width * height);

  free(tiles);
  return 0;
}
</code></pre> </section> <div style='clear:both;'></div> <footer> <section class="meta"> <p> <span class="byline author vcard">Posted by <span class="fn">Manuel</span></span> </p> <p class='categories'> <a class='category' href='/blog/categories/2021/'>2021</a>, <a class='category' href='/blog/categories/memory/'>memory</a>, <a class='category' href='/blog/categories/programming/'>programming</a>, <a class='category' href='/blog/categories/x86/'>x86</a> </p> </section> <section class='pagination'> <table><tr> <th class='left'><p><a href="/blog/2021/01/17/fortschritt-slash-ausblick-20-slash-21/" title="Previous Post: Fortschritt/Ausblick 20/21">&laquo; </a></p></th> <td class='left'><p><a href="/blog/2021/01/17/fortschritt-slash-ausblick-20-slash-21/" title="Previous Post: Fortschritt/Ausblick 20/21">Fortschritt/Ausblick 20/21</a></p></td> <td class='right'><p><a href="/blog/2021/01/30/fortsetzung/" title="Next Post: Fortsetzung (I)">Fortsetzung (I)</a></p></td> <th class='right'><p><a href="/blog/2021/01/30/fortsetzung/" title="Next Post: Fortsetzung (I)"> &raquo;</a></p></th> </tr></table> </section> </footer> </article> <footer><section class='posts'> <ul> <li><a href="/blog/2021/01/30/fortsetzung/">1. Fortsetzung (I)</a></li> <li><a href="/blog/2021/01/23/a-2-dimensional-data-structure/">2. A two dimensional data structure</a></li> <li><a href="/blog/2021/01/17/fortschritt-slash-ausblick-20-slash-21/">3. Fortschritt/Ausblick 20/21</a></li> <li><a href="/blog/2020/09/13/zahnradgetriebe/">4. Zahnradgetriebe</a></li> <li><a href="/blog/2020/09/06/getriebe-ubersetzung-1-96/">5. Getriebe-Ãœbersetzung (1:96)</a></li> </ul> </section> <section class='copyright'> <p> Copyright &copy; 2010-2021 | Manuel | <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> </p> </section> </footer> </body> </html>