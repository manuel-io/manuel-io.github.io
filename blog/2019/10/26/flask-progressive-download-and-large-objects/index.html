<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html manifest="cache.manifest" class="no-js" lang="en"><!--<![endif]-->

<head>
  <meta charset="utf-8">
  <title>Flask: Progressive Download &amp; Large Objects - A personal Blog</title>
  <meta name="author" content="Manuel">
  
  <meta name="keywords" content="2019, flask, python, programming, http, documentation">
  
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="apple-touch-icon" href="/style/touch-icon.png">
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/style/touch-icon.png">
  <link rel="canonical" href="https://manuel-io.github.io/blog/2019/10/26/flask-progressive-download-and-large-objects">
  <link rel="shortcut icon" type="image/png" href="/favicon.png"> 
  <link href="/stylesheets/screen.css" media="all" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="A personal Blog" type="application/atom+xml">
  <script src="/javascripts/libs/jquery-1.11.2.min.js" type="text/javascript"></script>
  <script src="/javascripts/blog.js" type="text/javascript"></script>
  <script type="text/javascript" src="/javascripts/mathjax/unpacked/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "jax": ["input/TeX", "output/HTML-CSS"],
    styles: { ".MathJax_Display": { "text-align": "left" } },
    "tex2jax": {
      inlineMath: [ ['$', '$'], ["\\(", "\\)"] ],
      displayMath: [ ['$$', '$$'], ["\\[", "\\]"] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: { autoNumber: "AMS" },
      TagSide: "left"
    },
    "HTML-CSS": {
      availableFonts: ["TeX"],
      linebreaks: { automatic: true }
    }
  });
</script>

</head>

<body >
  <header class='site'><h1>
  <a href="/">
    
    
    <p>A</p>
    
    <p> </p>
    
    <p>p</p>
    
    <p>e</p>
    
    <p>r</p>
    
    <p>s</p>
    
    <p>o</p>
    
    <p>n</p>
    
    <p>a</p>
    
    <p>l</p>
    
    <p> </p>
    
    <p>B</p>
    
    <p>l</p>
    
    <p>o</p>
    
    <p>g</p>
    
  </a>
</h1>
</header>
  <div style='clear:both;'></div>
  <nav><span><a href="/">Blog</a></span>
<span><a href="/blog/photography">Photography</a></span>
<span><a href="http://vkitchen.herokuapp.com" target="_blank">Kitchen</a></span>
<span><a href="https://minicloud.zahlenpresse.de" target="_blank">Minicloud</a></span>
<span><a href="https://github.com/manuel-io" target="_blank">Github</a></span>
<span><a href="https://de.wikipedia.org/wiki/Benutzer:Manuel_Bieling" target="_blank">Wikipedia</a></span>

<span><a href="/blog/links">Links</a></span>
<span><a href="/atom.xml">Feed</a></span>
<span><a href="/blog/tags">Tags</a></span>
<span><a href="/blog/archives">Archive</a></span>
<span><a href="/blog/about">About</a></span>
</nav>
  <article>
  
  <header class='post'>
    
      <h1 class="entry-title">Flask: Progressive Download &amp; Large Objects</h1>
    
    
      <p>
        




<time class='entry-date' datetime='2019-10-26T21:57:41+02:00'><span class='date'>Oct, 2019-10-26 | </span> <span class='time'>Sat, 21:57 </span></time>
        
      </p>
    
  </header>


<section><p>Often a progressive download is described as a stream but when it comes to the technical side it is important to distinguish. And we are talking about python&rsquo;s flask framework so we are talking about the capabilities of HTTP too. The feature of HTTP for using progressive download is the HTTP range request. And because it is rarely documented how to enable this feature in flask. I decided to write an article about my experiences.</p>

<p>During the implementation it is good to have the  appropriate RFC document at hand (<a href="https://tools.ietf.org/html/rfc7233">RFC7233</a>).</p>

<p>As far as I can say you can use the build in <a href="https://flask.palletsprojects.com/en/1.1.x/api/#flask.send_from_directory">function</a> <code>send_from_directory</code> which supports the feature.
Let&rsquo;s try it in a curl session, requesting a server which supports HTTP range:</p>

<pre><code>curl -vI -r 10-20  http://localhost:5000/files/download/e8cca36cbc06f670
</code></pre>

<p>Asking the server for a certain Range <code>Range: bytes=10-20</code> and receiving a valid answer:</p>

<pre><code>HTTP/1.0 206 PARTIAL CONTENT
Content-Type: image/jpeg
Accept-Ranges: bytes
Content-Range: bytes 10-20/2870224
Content-Length: 11
</code></pre>

<p>The server supports bytes and is returning <code>11 bytes</code> of a file with <code>2870224 bytes</code> in total. This is a nice feature but how about files that do not lie in the file system. I often store files in a database. This is when you have to implement the whole procedure by yourself. But it&rsquo;s still possible and thanks to the <a href="https://www.postgresql.org/docs/10/largeobjects.html">large objects</a> feature of PostgreSQL you can fetch for a certain range of bytes from a file stored in the database.</p>

<p>I&rsquo;m using this technique in a newer development version of the minicloud project. Check out my example on the <a href="https://github.com/manuel-io/minicloud/blob/f00d9c3136954929d193fbb74a683f8dea773d0c/files.py#L243-L289">Github page</a>.</p>
</section>

<div style='clear:both;'></div>

  <footer>
    <section class="meta">
      <p>
        
  

<span class="byline author vcard">Posted by <span class="fn">Manuel</span></span>

        <!--




<time class='entry-date' datetime='2019-10-26T21:57:41+02:00'><span class='date'>Oct, 2019-10-26 | </span> <span class='time'>Sat, 21:57 </span></time>-->
      </p>
      <p class='categories'>

  
    <a class='category' href='/blog/categories/2019/'>2019</a>, <a class='category' href='/blog/categories/documentation/'>documentation</a>, <a class='category' href='/blog/categories/flask/'>flask</a>, <a class='category' href='/blog/categories/http/'>http</a>, <a class='category' href='/blog/categories/programming/'>programming</a>, <a class='category' href='/blog/categories/python/'>python</a>
  

</p>
    </section>
    <section class='pagination'>
      <table><tr>
        
        <th class='left'><p><a href="/blog/2019/08/17/hitchhiker-to-the-climate-summit/"
            title="Previous Post: Hitchhiking to the climate summit">&laquo; </a></p></th>
        <td class='left'><p><a href="/blog/2019/08/17/hitchhiker-to-the-climate-summit/"
            title="Previous Post: Hitchhiking to the climate summit">Hitchhiking to the climate summit</a></p></td>
        
        
        <td class='right'><p><a href="/blog/2020/02/01/recent-work-end-2019/"
            title="Next Post: Recent Work (End 2019)">Recent Work (End 2019)</a></p></td>
        <th class='right'><p><a href="/blog/2020/02/01/recent-work-end-2019/"
            title="Next Post: Recent Work (End 2019)"> &raquo;</a></p></th>
        
      </tr></table>
    </section>
  </footer>
</article>

  <footer><section class='posts'>
  <ul>
  
  <li><a href="/blog/2021/01/17/fortschritt-slash-ausblick-20-slash-21/">1. Fortschritt/Ausblick 20/21</a></li>
  
  <li><a href="/blog/2020/09/13/zahnradgetriebe/">2. Zahnradgetriebe</a></li>
  
  <li><a href="/blog/2020/09/06/getriebe-ubersetzung-1-96/">3. Getriebe-Übersetzung (1:96)</a></li>
  
  <li><a href="/blog/2020/07/21/verschworungstheologien/">4. Verschwörungstheologien</a></li>
  
  <li><a href="/blog/2020/06/06/einfach-nur-leer/">5. Einfach nur Leer</a></li>
  
  </ul>
</section>
<section class='copyright'>
  <p>
    Copyright &copy; 2010-2021 | Manuel | <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  </p>
</section>
</footer>
</body>
</html>
